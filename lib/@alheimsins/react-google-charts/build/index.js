var o=require("react"),t=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#3B3EAC"],e=Object.freeze({DEFAULT_CHART_COLORS:t,default:t}),r=function(o){if(void 0===o&&(o=window),void 0===o)return{};if(void 0===o.google)throw new Error("google not in window object. Error in get-google-charts.");return o.google},a=new function(){var o=this;this.isLoaded=!1,this.isLoading=!1,this.loadScript=null,this.destroy=function(){o.isLoading=!1,o.isLoaded=!1,o.loadScript=null},this.init=function(t,e,r,a){if((o.isLoading||o.isLoaded)&&null!==o.loadScript)return o.loadScript;o.isLoading=!0;var n="undefined"!=typeof window?require("loadjs"):function(o,t){return(0,t.success)()};return o.loadScript=new Promise(function(i){n("https://www.gstatic.com/charts/loader.js",{success:function(){var n=function(o){if(void 0===o&&(o=window),void 0===o)return{};if(void 0===o.google)throw new Error("google not in window object. Error in get-google-charts.");return o.google.charts}(window);n.load(e||"current",{packages:t||["corechart"],language:r||"en",mapsApiKey:a}),n.setOnLoadCallback(function(){o.isLoaded=!0,o.isLoading=!1,i()})}})}),o.isLoading=!0,o.loadScript}},n=0,i=function(){return"reactgooglegraph-"+(n+=1)},s=function(n){function s(o){var a=this;n.call(this,o),this.chart=null,this.wrapper=null,this.hidden_columns={},this.dataTable=[],this.isUnmounted=!1,this.onResize=function(){a.drawChart()},this.onSelectToggle=function(){if(null!==a.chart&&a.props.legend_toggle){var o=a.chart.getSelection();if(o.length>0)if(null==o[0].row)a.togglePoints(o[0].column)}},this.getColumnColor=function(o){if(a.props.options&&a.props.options.colors){if(a.props.options.colors[o])return a.props.options.colors[o]}else if(o in e)return e[o];return e[0]},this.applyNumberFormat=function(o,t){new(r(window).visualization.NumberFormat)(t).format(a.dataTable,o)},this.applyDateFormat=function(o,t){new(r(window).visualization.DateFormat)(t).format(a.dataTable,o)},this.buildDataTableFromProps=function(){var o=a.props.chartType,t=r(window);if(a.props.diffdata&&null!==a.props.chartType){var e=a.props.diffdata,n=t.visualization.arrayToDataTable(e.old),i=t.visualization.arrayToDataTable(e.new);return(0,t.visualization[o].prototype.computeDiff)(n,i)}if(null===a.props.data&&a.props.rows&&0===a.props.rows.length&&!1==!a.props.allowEmptyRows)throw new Error("Can't build DataTable from rows and columns: rows array in props is empty");if(null===a.props.data&&a.props.columns&&0===a.props.columns.length)throw new Error("Can't build DataTable from rows and columns: columns array in props is empty");if(null!==a.props.data)try{return a.wrapper.setDataTable(a.props.data),a.wrapper.getDataTable()}catch(o){throw new Error("Failed to set DataTable from data props ! ",o)}var s=new window.google.visualization.DataTable;if(a.props.columns.forEach(function(o){s.addColumn(o)}),s.addRows(a.props.rows),a.props.numberFormat){var l=a.props.numberFormat;a.applyNumberFormat(l.column,l.options)}if(a.props.dateFormat){var p=a.props.dateFormat,d=p.options;p.columns.forEach(function(o){a.applyDateFormat(o,d)})}return a.props.formatters.forEach(function(o){var t=o.type,e=o.column,r=o.options;switch(t){case"NumberFormat":a.applyNumberFormat(e,r);break;case"DateFormat":a.applyDateFormat(e,r);break;default:console.log("Unkown formatter type: "+t)}}),s},this.updateDataTable=function(){return window.google.visualization.errors.removeAll(document.getElementById(a.wrapper.getContainerId())),a.dataTable.removeRows(0,a.dataTable.getNumberOfRows()),a.dataTable.removeColumns(0,a.dataTable.getNumberOfColumns()),a.dataTable=a.buildDataTableFromProps(),a.dataTable},this.drawChart=function(){if(!a.isUnmounted){if(a.wrapper){if(a.updateDataTable(),a.wrapper.setDataTable(a.dataTable),a.wrapper.setOptions(a.props.options),a.wrapper.getChartType()!==a.props.chartType){window.google.visualization.events.removeAllListeners(a.wrapper),a.wrapper.setChartType(a.props.chartType);var o=a;window.google.visualization.events.addOneTimeListener(a.wrapper,"ready",function(){o.chart=o.wrapper.getChart(),o.listenToChartEvents.call(o)})}}else a.wrapper=new window.google.visualization.ChartWrapper({chartType:a.props.chartType,options:a.props.options,containerId:a.state.graphID}),a.dataTable=a.buildDataTableFromProps(),a.wrapper.setDataTable(a.dataTable),window.google.visualization.events.addOneTimeListener(a.wrapper,"ready",function(){a.chart=a.wrapper.getChart(),a.listenToChartEvents(),a.addChartActions()});a.wrapper.draw()}},this.addChartActions=function(){null!==a.props.chartActions&&a.props.chartActions.forEach(function(o){a.chart.setAction({id:o.id,text:o.text,action:o.action.bind(a,a.chart)})})},this.listenToChartEvents=function(){a.props.legend_toggle&&window.google.visualization.events.addListener(a.wrapper,"select",a.onSelectToggle),a.props.chartEvents.forEach(function(o){var t;"ready"===o.eventName?o.callback(a):(t=o,window.google.visualization.events.addListener(a.chart,t.eventName,function(o){t.callback(a,o)}))})},this.buildColumnFromSourceData=function(o){return{label:a.dataTable.getColumnLabel(o),type:a.dataTable.getColumnType(o),sourceColumn:o,role:a.dataTable.getColumnRole(o)}},this.buildEmptyColumnFromSourceData=function(o){return{label:a.dataTable.getColumnLabel(o),type:a.dataTable.getColumnType(o),calc:function(){return null},role:a.dataTable.getColumnRole(o)}},this.addEmptyColumnTo=function(o,t){var e=a.buildEmptyColumnFromSourceData(t);o.push(e)},this.hideColumn=function(o,t){a.isHidden(t)||(a.hidden_columns[t]={color:a.getColumnColor(t-1)}),o.push("#CCCCCC")},this.addSourceColumnTo=function(o,t){var e=a.buildColumnFromSourceData(t);o.push(e)},this.isHidden=function(o){return void 0!==a.hidden_columns[o]},this.restoreColorTo=function(o,t){var e;a.isHidden(t)?(e=a.hidden_columns[t].color,delete a.hidden_columns[t]):e=a.getColumnColor(t-1),0!==t&&o.push(e)},this.debounce=function(o,t){var e;return function(){for(var r=[],a=arguments.length;a--;)r[a]=arguments[a];var n=this;clearTimeout(e),e=setTimeout(function(){return o.apply(n,r)},t)}},this.togglePoints=function(o){for(var e=new window.google.visualization.DataView(a.wrapper.getDataTable()),r=e.getNumberOfColumns(),n=a.props.options&&a.props.options.colors?a.props.options.colors:t,i=[],s=0;s<r;s+=1)0===s?a.addSourceColumnTo(i,s):s===o?a.isHidden(s)?(a.addSourceColumnTo(i,s),a.restoreColorTo(n,s)):(a.addEmptyColumnTo(i,s),a.hideColumn(n,s)):a.isHidden(s)?(a.addEmptyColumnTo(i,s),a.hideColumn(n,s)):(a.addSourceColumnTo(i,s),a.restoreColorTo(n,s));e.setColumns(i),a.props.options.colors=n,a.chart.draw(e,a.props.options)},this.state={graphID:o.graph_id||i()}}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.componentDidMount=function(){var o=this;"undefined"!=typeof window&&(this.props.loadCharts?a.init(this.props.chartPackages,this.props.chartVersion,this.props.chartLanguage,this.props.mapsApiKey).then(function(){o.drawChart(),o.onResize=o.debounce(o.onResize,200),window.addEventListener("resize",o.onResize)}):this.drawChart())},s.prototype.componentDidUpdate=function(){var o=this;this.props.loadCharts?a.isLoading?a.loadScript&&a.loadScript.then(function(){o.drawChart()}):a.isLoaded&&this.drawChart():this.drawChart()},s.prototype.componentWillUnmount=function(){this.isUnmounted=!0,a.destroy();try{window&&(window.google&&window.google.visualization&&window.google.visualization.events.removeAllListeners(this.wrapper),window.removeEventListener("resize",this.onResize))}catch(o){return}},s.prototype.render=function(){return o.createElement("div",{id:this.state.graphID,style:{height:this.props.height||this.props.options.height,width:this.props.width||this.props.options.width}},this.props.loader?this.props.loader:"Rendering Chart...")},s}(o.Component);s.defaultProps={chartType:"LineChart",rows:[],columns:[],options:{chart:{title:"Chart Title",subtitle:"Subtitle"},hAxis:{title:"X Label"},vAxis:{title:"Y Label"},width:"100%",height:"100%"},width:"400px",height:"300px",chartEvents:[],chartActions:null,data:null,legend_toggle:!1,allowEmptyRows:!1,loadCharts:!0,loader:o.createElement("div",null,"Rendering Chart"),chartPackages:["corechart"],chartVersion:"current",chartLanguage:"en",numberFormat:null,dateFormat:null,formatters:[],diffdata:null},module.exports={Chart:s};
//# sourceMappingURL=index.js.map
